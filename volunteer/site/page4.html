<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html>
  <head>
    <title>Living Hope</title>
    <link href="stylesheets/application.css" media="all" rel="stylesheet" type="text/css"/>
    <script language="javascript" src="javascripts/nav.js" type="text/javascript"></script><script language="javascript" src="javascripts/json2.js" type="text/javascript"></script><script language="javascript" src="javascripts/jquery-1.3.2.min.js" type="text/javascript"></script>
    <script type="text/javascript">
      //<![CDATA[
        if (typeof(Array.prototype.indexOf) == 'undefined') {
          Array.prototype.indexOf = function(value, start) {
            if (typeof(start) == 'undefined')
              start = 0;
            for (var i = start; i < this.length; i++) {
              if (this[i] == value)
                return i;
            }
            return -1;
          }
        }
        
        function getHTTPObject() {
          if (typeof XMLHttpRequest != 'undefined') {
            return new XMLHttpRequest();
          }
          try {
            return new ActiveXObject("Msxml2.XMLHTTP");
          }
          catch (e) {
            try {
              return new ActiveXObject("Microsoft.XMLHTTP");
            }
            catch (e) {}
          }
          alert("An unexpected error has occurred--your browser may not be supported");
          return null;
        }
        
        function syncExplain(baseId) {
          var display = $('#' + baseId + '-yes').get(0).checked ? 'block' : 'none';
          $('#' + baseId + '-explaincontainer').css('display', display);
        }
        
        function uploadInfo(info) {
          var xhr = getHTTPObject();
          xhr.open('POST', 'update.php', false);
          xhr.send(info);
          if (xhr.status == 200)
            return true;
          alert("Error while saving: " + xhr.responseText);
          return false;
        }
        
        function downloadInfo() {
          var xhr = getHTTPObject();
          xhr.open('GET', 'retrieve.php', false);
          xhr.send(null);
          if (xhr.readyState==4 && xhr.status==200) {
            return JSON.parse(xhr.responseText);
          }
          else {
            alert("Couldn't load existing data!\n" + xhr.responseText);
            return null;
          }
        }
        
        function save() {
          var info = {};
          for (var i = 0; i < save_handlers.length; i++) {
            save_handlers[i](info, document.mainform);
          }
          // Replacer function is a hack to work around this IE8 bug:
          // http://blogs.msdn.com/jscript/archive/2009/06/23/serializing-the-value-of-empty-dom-elements-using-native-json-in-ie8.aspx
          var payload = JSON.stringify(info, function(k, v) { return v === "" ? "" : v });
          //console.log(payload);
          return uploadInfo(payload);
        }
        
        function load(info) {
          for (var i = 0; i < load_handlers.length; i++) {
            load_handlers[i](info, document.mainform);
          }
        }
        
        load_handlers = [];
        save_handlers = [];
      //]]>
    </script>
  </head>
  <body>
    <div class="nav">
      Page:
      <a class="" href="javascript:if (save()) nav(1)">1</a>
      <a class="" href="javascript:if (save()) nav(2)">2</a>
      <a class="" href="javascript:if (save()) nav(3)">3</a>
      <a class="active" href="javascript:if (save()) nav(4)">4</a>
      <a class="" href="javascript:if (save()) nav(5)">5</a>
      <a class="" href="javascript:if (save()) nav(6)">6</a>
    </div>
    <form name="mainform">
      <div class="section">
        <h2>Biographical Information</h2>
        <div class="field">
          <label for="conversion">
            How and when did you become a Christian?
          </label>
          <br />
          <textarea cols="40" id="conversion" name="conversion" rows="5"></textarea>
          <script type="text/javascript">
            //<![CDATA[
              load_handlers.push(function (info) {
                var val = info['conversion'] || '';
                $('#conversion').get(0).value = val;
              });
              save_handlers.push(function (info, form) {
                info['conversion'] = $('#conversion').get(0).value;
              });
            //]]>
          </script>
        </div>
        <div class="field">
          <label for="lifechange">
            Describe how your life has changed.
          </label>
          <br />
          <textarea cols="40" id="lifechange" name="lifechange" rows="5"></textarea>
          <script type="text/javascript">
            //<![CDATA[
              load_handlers.push(function (info) {
                var val = info['lifechange'] || '';
                $('#lifechange').get(0).value = val;
              });
              save_handlers.push(function (info, form) {
                info['lifechange'] = $('#lifechange').get(0).value;
              });
            //]]>
          </script>
        </div>
        <div class="field">
          <label for="history">
            Please write a brief overview of your personal history (where you grew up, childhood experiences, and how these affect your life now).
          </label>
          <br />
          <textarea cols="70" id="history" name="history" rows="12"></textarea>
          <script type="text/javascript">
            //<![CDATA[
              load_handlers.push(function (info) {
                var val = info['history'] || '';
                $('#history').get(0).value = val;
              });
              save_handlers.push(function (info, form) {
                info['history'] = $('#history').get(0).value;
              });
            //]]>
          </script>
        </div>
        <div class="field">
          <label for="strength">
            What would others say is your strongest quality, and why?
          </label>
          <br />
          <textarea cols="40" id="strength" name="strength" rows="5"></textarea>
          <script type="text/javascript">
            //<![CDATA[
              load_handlers.push(function (info) {
                var val = info['strength'] || '';
                $('#strength').get(0).value = val;
              });
              save_handlers.push(function (info, form) {
                info['strength'] = $('#strength').get(0).value;
              });
            //]]>
          </script>
        </div>
        <div class="field">
          <label for="weakness">
            What would others say is your weakest quality, and why?
          </label>
          <br />
          <textarea cols="40" id="weakness" name="weakness" rows="5"></textarea>
          <script type="text/javascript">
            //<![CDATA[
              load_handlers.push(function (info) {
                var val = info['weakness'] || '';
                $('#weakness').get(0).value = val;
              });
              save_handlers.push(function (info, form) {
                info['weakness'] = $('#weakness').get(0).value;
              });
            //]]>
          </script>
        </div>
        <div class="field">
          <label for="submission">
            When do you find it difficult to submit to others?
          </label>
          <br />
          <textarea cols="40" id="submission" name="submission" rows="5"></textarea>
          <script type="text/javascript">
            //<![CDATA[
              load_handlers.push(function (info) {
                var val = info['submission'] || '';
                $('#submission').get(0).value = val;
              });
              save_handlers.push(function (info, form) {
                info['submission'] = $('#submission').get(0).value;
              });
            //]]>
          </script>
        </div>
        <div class="field">
          <label for="churchhistory">
            Describe your personal church history (various ones you've attended, why you switched, etc.).
          </label>
          <br />
          <textarea cols="70" id="churchhistory" name="churchhistory" rows="12"></textarea>
          <script type="text/javascript">
            //<![CDATA[
              load_handlers.push(function (info) {
                var val = info['churchhistory'] || '';
                $('#churchhistory').get(0).value = val;
              });
              save_handlers.push(function (info, form) {
                info['churchhistory'] = $('#churchhistory').get(0).value;
              });
            //]]>
          </script>
        </div>
        <div class="field">
          <label for="faith">
            Describe your personal &quot;statement of faith.&quot; What do you believe?
          </label>
          <br />
          <textarea cols="70" id="faith" name="faith" rows="12"></textarea>
          <script type="text/javascript">
            //<![CDATA[
              load_handlers.push(function (info) {
                var val = info['faith'] || '';
                $('#faith').get(0).value = val;
              });
              save_handlers.push(function (info, form) {
                info['faith'] = $('#faith').get(0).value;
              });
            //]]>
          </script>
        </div>
        <div class="field">
          <label for="southafrica">
            Do you feel specifically called to South Africa? Explain.
          </label>
          <br />
          <textarea cols="40" id="southafrica" name="southafrica" rows="5"></textarea>
          <script type="text/javascript">
            //<![CDATA[
              load_handlers.push(function (info) {
                var val = info['southafrica'] || '';
                $('#southafrica').get(0).value = val;
              });
              save_handlers.push(function (info, form) {
                info['southafrica'] = $('#southafrica').get(0).value;
              });
            //]]>
          </script>
        </div>
        <div class="field">
          <label for="fiveyearplan">
            Where do you want to be in five years? What is your personal vision for your life and ministry?
          </label>
          <br />
          <textarea cols="40" id="fiveyearplan" name="fiveyearplan" rows="5"></textarea>
          <script type="text/javascript">
            //<![CDATA[
              load_handlers.push(function (info) {
                var val = info['fiveyearplan'] || '';
                $('#fiveyearplan').get(0).value = val;
              });
              save_handlers.push(function (info, form) {
                info['fiveyearplan'] = $('#fiveyearplan').get(0).value;
              });
            //]]>
          </script>
        </div>
        <div class="field">
          <label for="calling">
            Explain how and why you feel God is calling you to be part of Living Hope. Also include what area of ministry you would specifically like to get involved in and how you see yourself fitting in.
          </label>
          <br />
          <textarea cols="70" id="calling" name="calling" rows="12"></textarea>
          <script type="text/javascript">
            //<![CDATA[
              load_handlers.push(function (info) {
                var val = info['calling'] || '';
                $('#calling').get(0).value = val;
              });
              save_handlers.push(function (info, form) {
                info['calling'] = $('#calling').get(0).value;
              });
            //]]>
          </script>
        </div>
        <div class="field">
          <label for="gifts">
            Please check all areas you consider yourself gifted in
          </label>
          <br />
          <script type="text/javascript">
            //<![CDATA[
              save_handlers.push(function (info) {
                info['gifts'] = [];
              });
            //]]>
          </script>
          <input id="gifts0" name="gifts" type="checkbox" value="Sports" />
          <label class="option" for="gifts0">
            Sports
          </label>
          <br />
          <script type="text/javascript">
            //<![CDATA[
              load_handlers.push(function (info) {
                var val = info['gifts'];
                $('#gifts0').get(0).checked = (typeof(val) != 'undefined')
                                                 && (val.indexOf('Sports') >= 0);
              });
              save_handlers.push(function (info) {
                var values = [];
                if ($('#gifts0').get(0).checked)
                  info['gifts'].push('Sports')
              });
            //]]>
          </script>
          <input id="gifts1" name="gifts" type="checkbox" value="Administration" />
          <label class="option" for="gifts1">
            Administration
          </label>
          <br />
          <script type="text/javascript">
            //<![CDATA[
              load_handlers.push(function (info) {
                var val = info['gifts'];
                $('#gifts1').get(0).checked = (typeof(val) != 'undefined')
                                                 && (val.indexOf('Administration') >= 0);
              });
              save_handlers.push(function (info) {
                var values = [];
                if ($('#gifts1').get(0).checked)
                  info['gifts'].push('Administration')
              });
            //]]>
          </script>
          <input id="gifts2" name="gifts" type="checkbox" value="Children" />
          <label class="option" for="gifts2">
            Children
          </label>
          <br />
          <script type="text/javascript">
            //<![CDATA[
              load_handlers.push(function (info) {
                var val = info['gifts'];
                $('#gifts2').get(0).checked = (typeof(val) != 'undefined')
                                                 && (val.indexOf('Children') >= 0);
              });
              save_handlers.push(function (info) {
                var values = [];
                if ($('#gifts2').get(0).checked)
                  info['gifts'].push('Children')
              });
            //]]>
          </script>
          <input id="gifts3" name="gifts" type="checkbox" value="Healthcare" />
          <label class="option" for="gifts3">
            Healthcare
          </label>
          <br />
          <script type="text/javascript">
            //<![CDATA[
              load_handlers.push(function (info) {
                var val = info['gifts'];
                $('#gifts3').get(0).checked = (typeof(val) != 'undefined')
                                                 && (val.indexOf('Healthcare') >= 0);
              });
              save_handlers.push(function (info) {
                var values = [];
                if ($('#gifts3').get(0).checked)
                  info['gifts'].push('Healthcare')
              });
            //]]>
          </script>
          <input id="gifts4" name="gifts" type="checkbox" value="Photography" />
          <label class="option" for="gifts4">
            Photography
          </label>
          <br />
          <script type="text/javascript">
            //<![CDATA[
              load_handlers.push(function (info) {
                var val = info['gifts'];
                $('#gifts4').get(0).checked = (typeof(val) != 'undefined')
                                                 && (val.indexOf('Photography') >= 0);
              });
              save_handlers.push(function (info) {
                var values = [];
                if ($('#gifts4').get(0).checked)
                  info['gifts'].push('Photography')
              });
            //]]>
          </script>
          <input id="gifts5" name="gifts" type="checkbox" value="Landscaping" />
          <label class="option" for="gifts5">
            Landscaping
          </label>
          <br />
          <script type="text/javascript">
            //<![CDATA[
              load_handlers.push(function (info) {
                var val = info['gifts'];
                $('#gifts5').get(0).checked = (typeof(val) != 'undefined')
                                                 && (val.indexOf('Landscaping') >= 0);
              });
              save_handlers.push(function (info) {
                var values = [];
                if ($('#gifts5').get(0).checked)
                  info['gifts'].push('Landscaping')
              });
            //]]>
          </script>
          <input id="gifts6" name="gifts" type="checkbox" value="Construction or Maintenance" />
          <label class="option" for="gifts6">
            Construction or Maintenance
          </label>
          <br />
          <script type="text/javascript">
            //<![CDATA[
              load_handlers.push(function (info) {
                var val = info['gifts'];
                $('#gifts6').get(0).checked = (typeof(val) != 'undefined')
                                                 && (val.indexOf('Construction or Maintenance') >= 0);
              });
              save_handlers.push(function (info) {
                var values = [];
                if ($('#gifts6').get(0).checked)
                  info['gifts'].push('Construction or Maintenance')
              });
            //]]>
          </script>
          <input id="gifts7" name="gifts" type="checkbox" value="Music" />
          <label class="option" for="gifts7">
            Music
          </label>
          <br />
          <script type="text/javascript">
            //<![CDATA[
              load_handlers.push(function (info) {
                var val = info['gifts'];
                $('#gifts7').get(0).checked = (typeof(val) != 'undefined')
                                                 && (val.indexOf('Music') >= 0);
              });
              save_handlers.push(function (info) {
                var values = [];
                if ($('#gifts7').get(0).checked)
                  info['gifts'].push('Music')
              });
            //]]>
          </script>
          <input id="gifts8" name="gifts" type="checkbox" value="Schoolteacher" />
          <label class="option" for="gifts8">
            Schoolteacher
          </label>
          <br />
          <script type="text/javascript">
            //<![CDATA[
              load_handlers.push(function (info) {
                var val = info['gifts'];
                $('#gifts8').get(0).checked = (typeof(val) != 'undefined')
                                                 && (val.indexOf('Schoolteacher') >= 0);
              });
              save_handlers.push(function (info) {
                var values = [];
                if ($('#gifts8').get(0).checked)
                  info['gifts'].push('Schoolteacher')
              });
            //]]>
          </script>
        </div>
        <div class="field">
          <label for="leadgifts">
            Of the areas you checked, please note which ones you would consider yourself strong enough to lead a team in projects within this area.
          </label>
          <br />
          <textarea cols="30" id="leadgifts" name="leadgifts" rows="3"></textarea>
          <script type="text/javascript">
            //<![CDATA[
              load_handlers.push(function (info) {
                var val = info['leadgifts'] || '';
                $('#leadgifts').get(0).value = val;
              });
              save_handlers.push(function (info, form) {
                info['leadgifts'] = $('#leadgifts').get(0).value;
              });
            //]]>
          </script>
        </div>
      </div>
      <div class="section">
        <h2>Volunteer Positions</h2>
        <div style="color:red">TODO</div>
      </div>
    </form>
    <script type="text/javascript">
      //<![CDATA[
        var existingInfo = downloadInfo();
        load(existingInfo);
        setInterval(save, 3000);
      //]]>
    </script>
  </body>
</html>
